<div style="overflow-y: scroll; height: 100%">
  <div>
    <scroll-sentinel element-class="firebot-item-table-header"></scroll-sentinel>
    <div
      class="light-bg sticky-top firebot-item-table-header"
      style="
        padding: 15px;
        margin: 15px 0;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
      "
    >
      <button
        ng-click="$ctrl.onAddNewClicked()"
        class="btn btn-primary hvr-icon-grow"
      >
        <i class="fas fa-plus-circle hvr-icon" style="margin-right: 5px"></i>
        {{$ctrl.addNewButtonText}}
      </button>

      <div style="display: flex; flex-direction: row; align-items: center">
        <div
          class="btn-group"
          style="margin-right: 10px"
          uib-dropdown
          ng-show="$ctrl.sortTagContext != null"
        >
          <button
            id="single-button"
            type="button"
            class="btn btn-default"
            uib-dropdown-toggle
          >
            {{sts.getSelectedSortTagDisplay($ctrl.sortTagContext)}}
            <span class="caret"></span>
          </button>
          <ul
            class="dropdown-menu"
            uib-dropdown-menu
            role="menu"
            aria-labelledby="single-button"
          >
            <li
              role="menuitem"
              ng-click="sts.setSelectedSortTag($ctrl.sortTagContext, null)"
            >
              <a href>All {{$ctrl.sortTagContext}}</a>
            </li>
            <li
              class="divider"
              ng-show="sts.getSortTags($ctrl.sortTagContext).length > 0"
            ></li>
            <li
              class="dropdown-header"
              ng-show="sts.getSortTags($ctrl.sortTagContext).length > 0"
            >
              Sort Tags
            </li>
            <li
              ng-repeat="tag in sts.getSortTags($ctrl.sortTagContext)"
              ng-click="sts.setSelectedSortTag($ctrl.sortTagContext, tag)"
              role="menuitem"
            >
              <a href>{{tag.name}}</a>
            </li>
            <li class="divider"></li>
            <li
              role="menuitem"
              ng-click="sts.showEditSortTagsModal($ctrl.sortTagContext)"
            >
              <a href>Edit sort tags</a>
            </li>
          </ul>
        </div>

        <searchbar
          ng-show="$ctrl.items.length > 0"
          placeholder-text="{{$ctrl.searchPlaceholder}}"
          query="searchQuery"
          style="flex-basis: 250px"
        ></searchbar>
      </div>
    </div>
    <div style="padding: 15px">
      <div
        ng-if="$ctrl.items.length === 0"
        class="noselect muted"
        style="padding-left: 13px"
      >
        <span class="hvr-bob"><i class="fas fa-arrow-up"></i></span
        ><span style="margin-left: 8px">{{$ctrl.noDataMessage}}</span>
      </div>
      <div
        ng-if="$ctrl.items.length > 0 && filteredItems && filteredItems.length < 1"
        class="noselect muted"
        style="padding-left: 13px"
      >
        <span style="margin-left: 8px">{{$ctrl.noneFoundMessage}}</span>
      </div>
      <table
        ng-show="$ctrl.items.length > 0 && (filteredItems == null || filteredItems.length > 0)"
        class="fb-table"
      >
        <thead>
          <tr style="font-size: 11px">
            <th ng-if="$ctrl.testButton == true" style="width: 5%"></th>

            <th
              ng-repeat="header in $ctrl.headers track by $index"
              ng-style="header.headerStyles"
              class="muted"
            >
              <div style="display: flex">
                <span style="display: inline-block"
                  ><i ng-show="header.icon" class="fas" ng-class="header.icon"></i
                ></span>
                <span
                  ng-show="header.name"
                  style="margin: 0 5px; display: inline-block"
                  >{{header.name}}</span
                >
              </div>
            </th>

            <th ng-if="$ctrl.sortTagContext != null" class="muted">
              <i class="fas fa-tag"></i> TAGS
            </th>

            <th ng-if="$ctrl.showStatusIndicator"></th>

            <th></th>
          </tr>
        </thead>
        <tbody ui-sortable="$ctrl.sortableOptions" ng-model="$ctrl.items">
          <tr
            ng-repeat="item in filteredItems = ($ctrl.items | sortTagSearch:sts.getSelectedSortTag($ctrl.sortTagContext) | filter:searchQuery) as visible track by item.id"
            style="width: 100%"
            context-menu="$ctrl.getContextMenu(item)"
          >
            <td ng-if="$ctrl.testButton == true" style="text-align: center">
              <span
                style="color: #2aa1c0; font-size: 20px"
                ng-click="onTestButtonClicked({ itemId: item.id })"
              >
                <i class="fas fa-play-circle clickable"></i>
              </span>
            </td>

            <td
              ng-repeat="header in $ctrl.headers track by $index"
              ng-style="header.cellStyles"
            >
              <sortable-table-cell
                data="item"
                header="header"
                cell-index="$index"
              ></sortable-table-cell>
            </td>

            <td
              ng-if="$ctrl.sortTagContext != null"
              style="max-width: 135px; min-width: 100px"
            >
              <div
                style="
                  display: flex;
                  flex-wrap: wrap;
                  width: 100%;
                  overflow: auto;
                  max-height: 45.25px;
                "
              >
                <span
                  ng-repeat="tagName in sts.getSortTagNames($ctrl.sortTagContext, item.sortTags)"
                  style="
                    background: gray;
                    border-radius: 15px;
                    padding: 1px 5px;
                    margin-right: 2px;
                    margin-bottom: 1px;
                    font-size: 10px;
                    line-height: 1.8;
                  "
                >
                  {{tagName}}
                </span>
              </div>
            </td>

            <td ng-if="$ctrl.showStatusIndicator">
              <status-indicator status="$ctrl.getStatus(item)" />
            </td>

            <td>
              <div
                style="
                  display: flex;
                  justify-content: flex-end;
                  align-items: center;
                "
              >
                <span
                  class="dragHandle"
                  ng-click="$event.stopPropagation();"
                  ng-if="$ctrl.orderable"
                  ng-show="sts.getSelectedSortTag($ctrl.sortTagContext) == null && (searchQuery == null || searchQuery.length < 1)"
                >
                  <i class="fal fa-bars" aria-hidden="true"></i>
                </span>
                <div style="text-align: right; margin-left: 25px">
                  <span
                    class="noselect clickable"
                    style="font-size: 30px"
                    context-menu="$ctrl.getContextMenu(item)"
                    context-menu-on="click"
                    ><i class="fal fa-ellipsis-h"></i
                  ></span>
                </div>
              </div>
            </td>
          </tr>

          <!-- 
          <tr
            ng-repeat="item in $ctrl.items | sortTagSearch:selectedSortTag | {{$ctrl.filterName}}:searchQuery as filteredItems track by item.id"
            context-menu="commandMenuOptions(command)"
            style="width: 100%"
          >
            <td ng-if="$ctrl.testButton" style="text-align: center">
              <span
                style="color: #2aa1c0; font-size: 20px"
                ng-click="testButtonClicked(item)"
              >
                <i class="fas fa-play-circle clickable"></i>
              </span>
            </td>

            <td class="command-trigger-cell">
              <span
                class="trigger"
                uib-tooltip="{{command.trigger}}"
                tooltip-popup-delay="500"
                tooltip-append-to-body="true"
                >{{command.trigger}}</span
              >
              <tooltip
                ng-if="command.triggerIsRegex"
                text="'Description: ' + command.regexDescription"
              ></tooltip>
              <span
                class="muted"
                style="margin-left: 5px; font-size: 11px"
                ng-show="command.hidden"
                uib-tooltip="Hidden from !commands list"
                tooltip-append-to-body="true"
              >
                <i class="fas fa-eye-slash"></i>
              </span>
            </td>
            <td>
              <span
                style="min-width: 51px; display: inline-block"
                uib-tooltip="Global cooldown"
              >
                <i class="far fa-globe-americas"></i> {{command.cooldown.global ?
                command.cooldown.global + "s" : "-" }}
              </span>
              <span uib-tooltip="User cooldown">
                <i class="far fa-user"></i> {{command.cooldown.user ?
                command.cooldown.user + "s" : "-" }}
              </span>
            </td>
            <td>
              <span style="text-transform: capitalize"
                >{{getPermisisonType(command)}}</span
              >
              <tooltip type="info" text="getPermissionTooltip(command)"></tooltip>
            </td>
            <td style="max-width: 135px; min-width: 100px">
              <div
                style="
                  display: flex;
                  flex-wrap: wrap;
                  width: 100%;
                  overflow: auto;
                  max-height: 45.25px;
                "
              >
                <span
                  ng-repeat="tagName in commandsService.getSortTagNames(command.sortTags)"
                  style="
                    background: gray;
                    border-radius: 15px;
                    padding: 1px 5px;
                    margin-right: 2px;
                    margin-bottom: 1px;
                    font-size: 10px;
                    line-height: 1.8;
                  "
                >
                  {{tagName}}
                </span>
              </div>
            </td>
            <td>
              <div
                style="
                  min-width: 75px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                "
              >
                <span
                  class="status-dot"
                  style="margin-right: 5px"
                  ng-class="{'active': command.active, 'notactive': !command.active}"
                ></span
                >{{command.active ? "Enabled" : "Disabled"}}
              </div>
            </td>
            <td>
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  align-items: center;
                "
              >
                <span
                  class="dragHandle"
                  ng-click="$event.stopPropagation();"
                  ng-show="commandsService.selectedSortTag == null && (commandsService.customCommandSearch == null || commandsService.customCommandSearch.length < 1)"
                >
                  <i class="fal fa-bars" aria-hidden="true"></i>
                </span>
                <div style="text-align: right; margin-left: auto">
                  <span
                    class="noselect clickable"
                    style="font-size: 30px"
                    context-menu="commandMenuOptions(command)"
                    context-menu-on="click"
                    ><i class="fal fa-ellipsis-h"></i
                  ></span>
                </div>
              </div>
            </td>
          </tr> -->
        </tbody>
      </table>
    </div>
    <div
      class="light-bg sticky-bottom firebot-item-table-footer"
      ng-transclude="footer"
    ></div>
    <scroll-sentinel element-class="firebot-item-table-footer"></scroll-sentinel>
  </div>
</div>
